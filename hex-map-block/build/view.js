(()=>{"use strict";const e={Template:{codeName:"Name",tradeGoods:{supply:[],demand:[]},modifier:{strength:1,supplyEffect:[],demandEffect:[]},codeClass:""},As:{codeName:"Asteroid Belt",tradeGoods:{supply:[31,42,44,45,53],demand:[15,21,22,25,32]},modifier:{strength:2,supplyEffect:["Mining"],demandEffect:[]},codeClass:"Planetary"},De:{codeName:"Desert",tradeGoods:{supply:[31,41,42,44,45,51,54],demand:[]},modifier:{strength:1,supplyEffect:["Resource","Mining"],demandEffect:[]},codeClass:"Planetary"},Fl:{codeName:"Fluid Oceans",tradeGoods:{supply:[41,44],demand:[15]},modifier:{strength:.5,supplyEffect:["Resource"],demandEffect:[]},codeClass:"Planetary"},Ga:{codeName:"Garden",tradeGoods:{supply:[33,34,51,55],demand:[]},modifier:{strength:2,supplyEffect:["Resource"],demandEffect:[]},codeClass:"Planetary"},He:{codeName:"Hell-World",tradeGoods:{supply:[],demand:[]},modifier:{strength:1,supplyEffect:[],demandEffect:[]},codeClass:"Planetary"},Ic:{codeName:"Ice-Capped",tradeGoods:{supply:[31,41,44,53],demand:[15,32]},modifier:{strength:1,supplyEffect:["Resource"],demandEffect:[]},codeClass:"Planetary"},Oc:{codeName:"Ocean World",tradeGoods:{supply:[26,35,41,42,51,54],demand:[]},modifier:{strength:.5,supplyEffect:["Resource"],demandEffect:[]},codeClass:"Planetary"},Va:{codeName:"Vacuum",tradeGoods:{supply:[],demand:[]},modifier:{strength:1,supplyEffect:[],demandEffect:[]},codeClass:"Planetary"},Wa:{codeName:"Water World",tradeGoods:{supply:[26,35,41,42,51,54],demand:[]},modifier:{strength:1,supplyEffect:["Resource"],demandEffect:[]},codeClass:"Planetary"},Di:{codeName:"Die-Back",tradeGoods:{supply:[],demand:[]},modifier:{strength:1,supplyEffect:[],demandEffect:[]},codeClass:"Population"},Ba:{codeName:"Barren",tradeGoods:{supply:[],demand:[]},modifier:{strength:1,supplyEffect:[],demandEffect:[]},codeClass:"Population"},Lo:{codeName:"Low Population",tradeGoods:{supply:[11,12,13,14,15,16,45],demand:[33]},modifier:{strength:1,supplyEffect:[],demandEffect:[]},codeClass:"Population"},Ni:{codeName:"Non-Industrial",tradeGoods:{supply:[11,12,13,14,15,16,52],demand:[11,12,16,21,22,43,53,56]},modifier:{strength:1,supplyEffect:[],demandEffect:["Consumables","Industrial"]},codeClass:"Population"},Ph:{codeName:"Pre-High Population",tradeGoods:{supply:[11,12,13,14,15,16,35,36,42],demand:[13,15,23,34,51,52,56]},modifier:{strength:.5,supplyEffect:[],demandEffect:["Consumables","Industrial"]},codeClass:"Population"},Hi:{codeName:"High Population",tradeGoods:{supply:[11,12,13,14,15,16,35,36,42],demand:[13,15,23,34,51,52,56]},modifier:{strength:1,supplyEffect:[],demandEffect:["Consumables","Industrial"]},codeClass:"Population"},Pa:{codeName:"Pre-Agricultural",tradeGoods:{supply:[26,33,34,52,54,55],demand:[12,41,46]},modifier:{strength:.5,supplyEffect:["Organic"],demandEffect:["Industrial"]},codeClass:"Output"},Ag:{codeName:"Agricultural",tradeGoods:{supply:[26,33,34,52,54,55],demand:[12,41,46]},modifier:{strength:1,supplyEffect:["Organic"],demandEffect:["Industrial"]},codeClass:"Output"},Na:{codeName:"Non-Agricultural",tradeGoods:{supply:[],demand:[52]},modifier:{strength:1,supplyEffect:[],demandEffect:["Consumables"]},codeClass:"Economic"},Pi:{codeName:"Pre-Industrial",tradeGoods:{supply:[21,22,23,24,25,43,46,56],demand:[14,16,26,31,36,44,45,53,54]},modifier:{strength:.5,supplyEffect:["Industrial"],demandEffect:["Resource","Mining"]},codeClass:"Output"},In:{codeName:"Industrial",tradeGoods:{supply:[21,22,23,24,25,43,46,56],demand:[14,16,26,31,36,44,45,53,54]},modifier:{strength:1,supplyEffect:["Industrial"],demandEffect:["Resource","Mining"]},codeClass:"Output"},Po:{codeName:"Poor",tradeGoods:{supply:[11],demand:[11,14,24,36,51]},modifier:{strength:1,supplyEffect:[],demandEffect:[]},codeClass:"Economic"},Pr:{codeName:"Pre-Rich",tradeGoods:{supply:[],demand:[21,23,25,31,32,35,36,42,43,44,51,55]},modifier:{strength:1,supplyEffect:[],demandEffect:[]},codeClass:"Economic"},Ri:{codeName:"Rich",tradeGoods:{supply:[],demand:[21,23,25,31,32,35,36,42,43,44,51,55]},modifier:{strength:1,supplyEffect:[],demandEffect:[]},codeClass:"Economic"}},t=[{id:11,goodsName:"Basic Electronics",goodsClass:"Industrial",basePrice:10},{id:12,goodsName:"Basic Machine Parts",goodsClass:"Industrial",basePrice:10},{id:13,goodsName:"Basic Manufactured Goods",goodsClass:"Industrial",basePrice:10},{id:14,goodsName:"Basic Raw Materials",goodsClass:"Resource",basePrice:5},{id:15,goodsName:"Basic Consumables",goodsClass:"Comsumables",basePrice:2},{id:16,goodsName:"Basic Ore",goodsClass:"Mining",basePrice:1},{id:21,goodsName:"Advanced Electronics",goodsClass:"Industrial",basePrice:100},{id:22,goodsName:"Advanced Machine Parts",goodsClass:"Industrial",basePrice:75},{id:23,goodsName:"Advanced Manufactured Goods",goodsClass:"Industrial",basePrice:100},{id:24,goodsName:"Advanced Weapons",goodsClass:"Industrial",basePrice:150},{id:25,goodsName:"Advanced Vehicles",goodsClass:"Industrial",basePrice:180},{id:26,goodsName:"Biochemicals",goodsClass:"Resource",basePrice:50},{id:31,goodsName:"Crystals and Gems",goodsClass:"Mining",basePrice:20},{id:32,goodsName:"Cybernetics",goodsClass:"Industial",basePrice:250},{id:33,goodsName:"Live Animals",goodsClass:"Resource",basePrice:10},{id:34,goodsName:"Luxury Consumables",goodsClass:"Consumables",basePrice:20},{id:35,goodsName:"Luxury Goods",goodsClass:"Industrial",basePrice:200},{id:36,goodsName:"Medical Supplies",goodsClass:"Industrial",basePrice:50},{id:41,goodsName:"Petrochemicals",goodsClass:"Resource",basePrice:10},{id:42,goodsName:"Pharmaceuticals",goodsClass:"Industrial",basePrice:100},{id:43,goodsName:"Polymers",goodsClass:"Resource",basePrice:7},{id:44,goodsName:"Precious Metals",goodsClass:"Resource",basePrice:50},{id:45,goodsName:"Radioactives",goodsClass:"Resource",basePrice:1e3},{id:46,goodsName:"Robots",goodsClass:"Industrial",basePrice:400},{id:51,goodsName:"Spices",goodsClass:"Comsumables",basePrice:6},{id:52,goodsName:"Textiles",goodsClass:"Industrial",basePrice:3},{id:53,goodsName:"Uncommon Ore",goodsClass:"Mining",basePrice:5},{id:54,goodsName:"Uncommon Raw Materials",goodsClass:"Resource",basePrice:20},{id:55,goodsName:"Wood",goodsClass:"Resource",basePrice:1},{id:56,goodsName:"Vehicles",goodsClass:"Industrial",basePrice:15}],s=[11,12,13,14,15,16],o=[[[1,1],[1,0],[0,-1],[-1,0],[-1,1],[0,1]],[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[0,1]]];function a(e){let t=0;for(let s=0;s<e;s++)t+=Math.floor(6*Math.random()+1);return t}function n(e){let t,s,o;for(s=document.getElementsByClassName("tab-content"),t=0;t<s.length;t++)s[t].style.display="none";for(o=document.getElementsByClassName("tab-links"),t=0;t<o.length;t++)o[t].className=o[t].className.replace(" active","");let a=e.target.id;document.getElementById(a).className+=" active",null!=a&&(a+="-content",document.getElementById(a).style.display="block")}class d{constructor(e,t,s){this.originId=e.id,this.targetId=t.id,this.originCenterPoint=e.centerPoint,this.targetCenterPoint=t.centerPoint,this.data=s,this.trafficWeight=this.setTrafficWeight(this.data),this.drawConnectingLine(this.originId,this.targetId,this.originCenterPoint,this.targetCenterPoint,this.trafficWeight)}setTrafficWeight(e){let t=0;return e.forEach((e=>{t=e.weight+t})),t}drawConnectingLine(e,t,s,o,a){const n=document.getElementById("trade-group");a>10&&(a=10);let d=document.createElementNS("http://www.w3.org/2000/svg","line");d.setAttribute("x1",`${s.x}`),d.setAttribute("y1",`${s.y}`),d.setAttribute("x2",`${o.x}`),d.setAttribute("y2",`${o.y}`),d.setAttribute("class","tradeLine"),d.setAttribute("id",`{origin : ${e}, destination : ${t}}`),d.setAttribute("style",`stroke:red; stroke-width: ${a}`),n.appendChild(d)}}class i{constructor(e,t,o,a){this.techLevel=e,this.govtTier=t,this.tradeCodes=a,this.popRoll=o,this.tradeCapacity=this.setTradeCapacity(this.tradeCodes,this.popRoll),this.tradeInfo=this.setTradeInfo(this.popRoll,this.tradeCodes,s),this.tradeBalance=0,this.tradeRoutes=new Map([])}setTradeCapacity(e,t){let s,o;return e.includes("Ba")&&(s=0),e.includes("Lo")&&(s=1),e.includes("Ni")&&(s=2),e.includes("Ph")&&(s=4),e.includes("Hi")&&(s=8),o=s*t,o}setTradeInfo(e,t){let s=[],o=[],a={};return t.forEach((t=>{let a=[t];s.push(...this.setSupply(e,a)),o.push(...this.setDemand(e,a))})),a.supply=s,a.demand=o,a=this.setInitialPricing(a),a}setSystemModifiers(t){let s=[];return t.forEach((t=>{s.push(e[t].modifiers)})),s}setSupply(t,s){let o=[],a=[];return s.forEach((s=>{let n=e[s],d=n.tradeGoods.supply;o.push(...d),o.forEach((e=>{let s,o=this.getGoodsDetails(e);s=n.modifier.supplyEffect.includes(o.goodsClass)?10*n.modifier.strength*(t*t):t*t*1,o.supplyAmount=s,a.push({id:o.id,good:o.goodsName,basePrice:o.basePrice,supplyAmount:o.supplyAmount,foundDemand:0})}))})),a}setDemand(t,s){let o=[],a=[];return s.forEach((s=>{let n=e[s],d=n.tradeGoods.demand;o.push(...d),o.forEach((e=>{let s,o=this.getGoodsDetails(e);s=n.modifier.demandEffect.includes(o.goodsClass)?10*n.modifier.strength*(t*t):t*t*1,o.demandAmount=s,a.push({id:o.id,good:o.goodsName,basePrice:o.basePrice,demandAmount:o.demandAmount,foundSupply:0})}))})),a}getGoodsDetails(e){return t.find((({id:t})=>t===e))}setInitialPricing(e){let t=this.updateSupply(e.supply),s=this.updateDemand(e.demand);return e.supply=t,e.demand=s,e}updateSupply(e){return e.forEach((e=>{e.price=e.basePrice})),e}updateDemand(e){return e.forEach((e=>{e.price=e.basePrice})),e}findTradePartners(e,t,s){const o=this.tradeInfo.demand,a=this.tradeCapacity,n=t.system.economicData.tradeInfo,i=[];let l;return o.forEach((e=>{let t=n.supply.find((t=>t.id==e.id));if(t){if(console.log(`Found Supplier: ${t.good}`),null==e.foundSupply&&(e.foundSupply=0),e.demandAmount>e.foundSupply){let s=[e.demandAmount-e.foundSupply,a,t.supplyAmount],o=Math.min(...s);e.foundSupply,i.push({weight:o})}e.demandAmount>=e.foundSupply&&s.push(e.id)}})),i.length>0&&(l=new d(e,t,i),this.tradeRoutes.set(this.tradeRoutes.length,l)),s}}const l={SIZE:[800,1600,3200,4800,6400,8e3,9600,11200,12800,14400,16e3],GRAVITY:["Negligible",.05,.15,.25,.35,.45,.7,.9,1,1.25,1.4],ATMO:["None","Trace","Very Thin, Tainted","Very Thin","Thin, Tainted","Thin","Standard","Standard, Tainted","Dense","Dense, Tainted","Exotic","Corrosive","Insidious","Dense, High","Thin, Low","Unusual"],PSIMIN:[0,.001,.1,.1,.43,.43,.71,.71,1.5,1.5,.43,.43,.43,1.5,.1,0],PSIMAX:[0,.09,.42,.42,.7,.7,1.49,1.49,2.49,2.49,2.49,2.49,2.49,5,.5,5],HYDROMIN:[0,6,16,26,36,46,56,66,76,86,96],HYDROMAX:[5,15,25,35,45,55,65,75,85,95,100],HYDRO:["Desert World","Dry World","A few small seas","Small seas and oceans","Wet World","Large oceans","","Terran Standard","Water world","Only a few small islands and archipelagos","Almost entirely water","None"],GOV:["None","Company/Corporation","Participating Democracy","Self-Perpetuating Oligarchy","Representative Democracy","Feudal Technocracy","Captive Government","Balkanisation","Civil Service Bureaucracy","Impersonal Bureaucracy","Charismatic Dictator","Non-Charistmatic Dictator","Charismatic Oligarchy","Religious Dictatorship"]},r=[{code:"As",siz:[0],atm:[0],hyd:[0],pop:[],gov:[],law:[]},{code:"De",siz:[],atm:[2,3,4,5,6,7,8,9],hyd:[0],pop:[],gov:[],law:[]},{code:"Fl",siz:[],atm:[10,11,12],hyd:[1,2,3,4,5,6,7,8,9,10],pop:[],gov:[],law:[]},{code:"Ga",siz:[6,7,8],atm:[5,6,8],hyd:[5,6,7],pop:[],gov:[],law:[]},{code:"He",siz:[3,4,5,6,7,8,9,10,11,12],atm:[2,3,7,8,10,11,12],hyd:[0,1,2],pop:[],gov:[],law:[]},{code:"Ic",siz:[],atm:[0,1],hyd:[1,2,3,4,5,6,7,8,9,10],pop:[],gov:[],law:[]},{code:"Oc",siz:[10,11,12],atm:[3,4,5,6,7,8,9,10,11,12],hyd:[10],pop:[],gov:[],law:[]},{code:"Va",siz:[],atm:[0],hyd:[],pop:[],gov:[],law:[]},{code:"Wa",siz:[3,4,5,6,7,8,9,10],atm:[3,4,5,6,7,8,9,10,11,12],hyd:[10],pop:[],gov:[],law:[]},{code:"Ba",siz:[],atm:[],hyd:[],pop:[0],gov:[],law:[]},{code:"Lo",siz:[],atm:[],hyd:[],pop:[1,2,3],gov:[],law:[]},{code:"Ni",siz:[],atm:[],hyd:[],pop:[4,5,6],gov:[],law:[]},{code:"Ph",siz:[],atm:[],hyd:[],pop:[7,8],gov:[],law:[]},{code:"Hi",siz:[],atm:[],hyd:[],pop:[9,10,11,12,13,14,15],gov:[],law:[]},{code:"Pa",siz:[],atm:[4,5,6,7,8,9],hyd:[4,5,6,7,8],pop:[4,8],gov:[],law:[]},{code:"Ag",siz:[],atm:[4,5,6,7,8,9],hyd:[4,5,6,7,8],pop:[5,6,7],gov:[],law:[]},{code:"Na",siz:[],atm:[0,1,2,3],hyd:[],pop:[6,7,8,9,10,11,12,13,14,15],gov:[],law:[]},{code:"Pi",siz:[],atm:[0,1,2,4,7,9],hyd:[],pop:[7,8],gov:[],law:[]},{code:"In",siz:[],atm:[0,1,2,3,7,9,10,11,12],hyd:[],pop:[9,10,11,12,13,14,15],gov:[],law:[]},{code:"Po",siz:[],atm:[2,3,4,5],hyd:[0,1,2,3],pop:[],gov:[],law:[]},{code:"Pr",siz:[],atm:[6,8],hyd:[],pop:[5,9],gov:[],law:[]},{code:"Ri",siz:[],atm:[6,8],hyd:[],pop:[6,7,8],gov:[],law:[]}];class c{constructor(e,t){this.id=e,this.centerPoint=t,this.systemRolls=this.setSystemRolls(),this.systemData={systemName:this.generateName(),size:this.setSize(this.systemRolls.get("planetSize")),atmosphere:this.setAtmosphere(this.systemRolls.get("atmoType")),hydrographics:this.setHydrographics(this.systemRolls.get("hydroType"),this.systemRolls.get("planetSize")),population:this.setPopulation(this.systemRolls.get("population")),government:this.setGovernment(this.systemRolls.get("government")),lawLevel:this.setLaw(this.systemRolls.get("lawLevel")),techLevel:this.setTL(this.systemRolls.get("tl")),starport:this.setStarport(this.systemRolls.get("starport")),tradeCodes:this.setTradeCodes(this.systemRolls,r)},this.uwp=this.setUWP(this.systemRolls),this.economicData=new i(this.systemRolls.get("tl"),this.systemRolls.get("government"),this.systemRolls.get("population"),this.systemData.tradeCodes),this.init()}init(){this.tableData()}setSystemRolls(){let e=new Map([]),t=a(2)-2;e.set("planetSize",t);let s=a(2)-7+e.get("planetSize");s<0&&(s=0),e.set("atmoType",s);let o=0,n=e.get("atmoType");0!==n&&1!==n&&10!==n&&11!==n&&12!==n||(o=-4);let d=a(2)-7+e.get("planetSize")+o;d<0?e.set("hydroType",0):e.set("hydroType",d);let i=a(2)-2;e.set("population",i);let l=a(2)-7+e.get("population"),r=l;l>13&&(r=13),l<0&&(r=0),e.set("government",r);let c=a(2)-7+r;c<0&&(l=0,c=0),e.set("lawLevel",c);let m,u=a(2);e.set("starport",u),m=u>=11?6:u>8&&u<11?4:u>6&&u<8?2:u>2&&u<7?0:-4;let p=0;p=t>1&&t<5?1:t<2?2:0;let h=0;(s<4||s>9)&&(h=1);let g=0;0===d||9===d?g=1:10===d&&(g=2);let y=0;i>0&&i<6||9===i?y=1:10===i?y=2:11===i?y=3:12===i&&(y=4);let f=0;0===r||5===r?f=1:7===r?f=2:13!==r&&14!==r||(f=-2);let C=a(1)+m+p+h+g+y+f;return C<0&&(C=0),e.set("tl",C),e}tableData(){let t,s=this.systemData.population.totalPopulation.toLocaleString(),o=[],a=`${this.systemData.hydrographics.hydroPercent}%`;return this.systemData.tradeCodes.forEach((t=>{o.push(e[t].codeName)})),t=o.join(", "),this.tableData={UWP:`${this.uwp}`,Name:this.systemData.systemName,Size:`${this.systemData.size.size} km`,Gravity:`${this.systemData.size.gravity} Earth Normal`,Atmosphere:`${this.systemData.atmosphere.atmo} at ${this.systemData.atmosphere.psi} psi.`,Hydropgraphics:a,Population:s,Government:this.systemData.government.governmentType,"Law Level":this.systemData.lawLevel.lawLevel,"Starport Grade":this.systemData.starport,"Tech Level":this.systemData.techLevel.tl,"Trade Code":t}}generateName(){return((e=6)=>Math.random().toString(20).substr(2,e))(6)}setSize(e){let t=e;return{size:l.SIZE[t],gravity:l.GRAVITY[t]}}setAtmosphere(e){let t=e,s=(o=l.PSIMIN[t],a=l.PSIMAX[t],Math.floor(Math.random()*(1e3*a-1e3*o+1+1e3*o))/1e3);var o,a;return{atmo:l.ATMO[t],psi:s}}setHydrographics(e,t){let s=e;e>10&&(e=10);let o=(a=l.HYDROMIN[s],n=l.HYDROMAX[s],Math.floor(Math.random()*(n-a+1+a)*100)/100);var a,n;let d=e;return t<=1&&(o=0,d=11),{hydroPercent:o,hydroDesc:l.HYDRO[s]}}setPopulation(e){let t=e;return{totalPopulation:Math.pow(10,t)+Math.floor(Math.random()*Math.pow(10,t))-1}}setGovernment(e){return{governmentType:l.GOV[e]}}setLaw(e){let t=e;return t>9&&(t=9),t<0&&(t=0),{lawLevel:t}}setStarport(e){let t;return t=e>10?"A":10===e||9===e?"B":8===e||7===e?"C":6===e||5===e?"D":4===e||3===e?"E":"X",t}setTL(e){return{tl:e}}setTradeCodes(e,t){let s=[],o=e.get("planetSize"),a=e.get("atmoType"),n=e.get("hydroType"),d=e.get("population"),i=e.get("government"),l=e.get("lawLevel");return t.forEach((e=>{let t=[];0===e.siz.length||e.siz.includes(o)?t.push(!0):t.push(!1),0===e.atm.length||e.atm.includes(a)?t.push(!0):t.push(!1),0===e.hyd.length||e.hyd.includes(n)?t.push(!0):t.push(!1),0===e.pop.length||e.pop.includes(d)?t.push(!0):t.push(!1),0===e.gov.length||e.gov.includes(i)?t.push(!0):t.push(!1),0===e.law.length||e.law.includes(l)?t.push(!0):t.push(!1),t.includes(!1)||s.push(e.code)})),s}setUWP(e){return`${this.systemData.starport}-${this.numToHex(e.get("planetSize"))}${this.numToHex(e.get("atmoType"))}${this.numToHex(e.get("hydroType"))}${this.numToHex(e.get("population"))}${this.numToHex(e.get("government"))}${this.numToHex(e.get("lawLevel"))}${this.numToHex(e.get("tl"))}`}numToHex(e){let t=e.toString(16);return t=t.toUpperCase(),t}}class m{constructor(e,t,s){this.col=e,this.row=t,this.scale=s,this.SectorMap=this.makeSectorMap(this.col,this.row,this.scale),this.systemList=this.makeSystemList(this.SectorMap)}makeSectorMap(e,t,s){let a=new Map,n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("id","hex-container"),n.id="hex-container",document.getElementById("svg-container").appendChild(n);let d=s,i=(t+.5)*(Math.sqrt(3)*d)+6,l=(e+.5)*(1.5*d)+6;document.getElementById("hex-container").setAttribute("height",`${Math.floor(i)}`),document.getElementById("hex-container").setAttribute("width",`${Math.floor(l)}`);let r=document.createElementNS("http://www.w3.org/2000/svg","g");r.setAttribute("id","trade-group"),n.appendChild(r);let c=document.createElementNS("http://www.w3.org/2000/svg","g");c.setAttribute("id","hex-group"),n.appendChild(c);for(let o=0;o<e;o++){let e=o+1;for(let o=0;o<t;o++){let t=o+1,n=new u(e,t,s),d=[e,t];a.set(d,n)}}return a.forEach(((s,n,d)=>{let i=[],l=o[0];s.col%2!=0&&(l=o[1]),l.forEach((o=>{let n=s.col+o[0],d=s.row+o[1];n>0&&n<=e&&d>0&&d<=t&&a.forEach(((e,t)=>{e.col==n&&e.row==d&&i.push(t)}))})),s.edges=i})),a}makeSystemList(e){let t=new Map,s=0;return e.forEach(((e,o)=>{if(null!=e.system){let a={localID:o,hex:e.system.id,name:e.system.tableData.Name,uwp:e.system.tableData.UWP};t.set(s,a),s++}})),t}}class u{constructor(e,t,s){this.col=e,this.row=t,this.hexSize=s,this.centerPoint=this.hexCenter(),this.axialCoord=this.oddqToAxial(),this.id=`${this.col-1}, ${this.row-1}`,this.system=this.setSystem(this.id,this.centerPoint),this.init()}init(){this.createHex(this.col,this.row)}hexCenter(){let e=this.col*(1.5*this.hexSize)-this.hexSize/2+3,t=this.row*(Math.sqrt(3)*this.hexSize)-Math.sqrt(3)*this.hexSize/2+3;return this.col%2||(t+=Math.sqrt(3)/2*this.hexSize),{x:e,y:t}}oddqToAxial(){return{q:this.col,r:this.row-(this.col-(this.col%2==0?this.col:0))}}createHex(){let e=document.createElementNS("http://www.w3.org/2000/svg","polygon"),t=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttribute("points",this.hexPoints()),e.setAttribute("id",`${this.id}`),t.setAttribute("class","hex"),t.setAttribute("class","hex-group"),t.addEventListener("click",(()=>{this.hexOnClick(this)})),t.appendChild(e),document.getElementById("hex-group").appendChild(t),this.system&&this.setMarker(t)}setSystem(e,t){return a(1)>3?new c(e,t):null}hexOnClick(e){let s=document.getElementById("system-information-content"),o=document.getElementById("system-trade-content"),a=document.getElementsByClassName("tab-links active"),d=a[0].id;"all-systems"===d&&(a={target:{id:"system-information"}}),"system-information"===d&&(a={target:{id:"system-information"}}),"system-trade"===d&&(a={target:{id:"system-trade"}}),e.system&&(s.hasChildNodes()&&(s.innerHTML=""),o.hasChildNodes()&&(o.innerHTML=""),function(e){let t=document.getElementById("content-container"),s=document.getElementById("system-information-content");null==s&&(s=document.createElement("div"),s.setAttribute("id","system-information-content"));let o=document.createElement("table");o.setAttribute("class","info-table");let a=[],n=[];for(const t in e)a.push(t),n.push(e[t]);for(let e=0;e<a.length;e++){let t=o.insertRow(e),s=t.insertCell(0),d=t.insertCell(1);s.innerHTML=a[e],d.innerHTML=n[e]}t.appendChild(s),s.appendChild(o)}(e.system.tableData),e.system.economicData&&function(e){let s=e.tradeInfo.supply,o=e.tradeInfo.demand,a=document.getElementById("content-container"),n=document.getElementById("system-trade-content");null===n&&(n=document.createElement("div"),n.setAttribute("id","system-trade-content"));let d=document.createElement("table"),i=document.createElement("tbody");d.setAttribute("class","info-table");let l=[],r=[],c=t.map((({goodsName:e})=>e));c.forEach(((e,t)=>{let a=s.find((({good:t})=>t===e));a&&l.push({index:t,amount:a.supplyAmount,price:a.price});let n=o.find((({good:t})=>t===e));n&&r.push({index:t,amount:n.demandAmount,price:n.price})}));let m=document.createElement("tr"),u=document.createElement("td"),p=document.createTextNode("Trade Goods"),h=document.createElement("td"),g=document.createTextNode("Supply"),y=document.createElement("td"),f=document.createTextNode("Demand");u.appendChild(p),h.appendChild(g),y.appendChild(f),m.appendChild(u),m.appendChild(h),m.appendChild(y),i.appendChild(m);for(let e=0;e<c.length;e++){let t=document.createElement("tr"),s=document.createElement("td"),o=document.createElement("td"),a=document.createElement("td"),n=document.createTextNode(c[e]),d=l.find((({index:t})=>t===e)),m=r.find((({index:t})=>t===e)),u=document.createTextNode("Not available"),p=document.createTextNode("Not needed");d&&(u=document.createTextNode(`${d.amount} units, at ${d.price} per unit`)),m&&(p=document.createTextNode(`${m.amount} units, at ${m.price} per unit`)),s.appendChild(n),o.appendChild(u),a.appendChild(p),t.appendChild(s),t.appendChild(o),t.appendChild(a),"Not available"===u.textContent&&"Not needed"===p.textContent||i.appendChild(t)}a.appendChild(n),d.appendChild(i),n.appendChild(d)}(e.system.economicData),n(a)),document.querySelectorAll(".clicked-hex").forEach((e=>e.setAttribute("class","hex"))),document.getElementById(e.id).setAttribute("class","clicked-hex")}hexPoints(){this.hexCenter();let e=this.centerPoint.x,t=this.centerPoint.y,s="";for(let o=0;o<6;o++){const a=60*o,n=Math.PI/180*a;let d=this.hexSize*Math.cos(n),i=this.hexSize*Math.sin(n);d+=e,i+=t,s+=`${Math.floor(d)}, ${Math.floor(i)} `}return s}setMarker(e){let t=this.centerPoint.x,s=this.centerPoint.y,o=document.createElementNS("http://www.w3.org/2000/svg","circle");o.setAttribute("cx",t),o.setAttribute("cy",s),o.setAttribute("r",10),o.setAttribute("id","marker"),e.appendChild(o)}}function p(){return document.getElementById("hex-container").sectorDataContainer.sector.SectorMap}function h(e,t){e.system&&this.push(t)}function g(e,t,s,o,a){const n=p(),d=n.get(t),i=n.get(e),l=[];s++,i.system&&d.system&&d.system.economicData.findTradePartners(d,i,l),o.system.economicData.tradeInfo.demand.forEach((e=>{if(e.demandAmount>e.foundSupply){const t=l.indexOf(e.id);t>-1?l.splice(t,1):l.push(e.id)}})),l.length>0&&s<2&&i.edges.forEach((t=>g(t,e,s,o,a)))}console.log("Hello World! (from create-block-hex-map-block block)"),document.getElementById("generator-button").addEventListener("click",(function(e){const t={};let s=e.target.parentElement,o=s.col.value,a=s.row.value,d=s.scale.value;o||(o=8),a||(a=10),d||(d=40),0===document.querySelectorAll("#hex-container").length&&(t.sector=new m(o,a,d)),document.getElementById("tab-display").style.display="block";let i=document.getElementsByClassName("tab-links");for(let e=0;e<i.length;e++)i[e].style.display="block",i[e].addEventListener("click",n);let l=document.getElementsByClassName("tab-links");for(let e=0;e<l.length;e++)l[e].className=l[e].className.replace(" active","");document.getElementById("all-systems").className+=" active",function(e){let t=document.getElementById("all-systems-content"),s=document.createElement("table");s.setAttribute("class","info-table"),t.appendChild(s);let o=s.insertRow(0);o.insertCell(0).innerHTML="Hex",o.insertCell(1).innerHTML="Name",o.insertCell(2).innerHTML="UWP";for(let t=1;t<e.size;t++){let o=e.get(t),a=s.insertRow(t),n=a.insertCell(0),d=a.insertCell(1),i=a.insertCell(2);n.innerHTML=o.hex,d.innerHTML=o.name,i.innerHTML=o.uwp}}(t.sector.systemList),document.getElementById("run-button").style.display="block",document.getElementById("reset-button").style.display="block",document.getElementById("map-generator").style.display="none",document.getElementById("hex-container").sectorDataContainer=t})),document.getElementById("reset-button").addEventListener("click",(function(){if(document.getElementById("map-generator").style.display="inline-flex",document.getElementById("run-button").style.display="none",document.getElementById("reset-button").style.display="none",null!==document.getElementById("system-information-content")){let e=document.getElementById("system-information-content"),t=e.firstElementChild,s=document.getElementById("all-systems-content"),o=s.firstElementChild;null!==t&&e.removeChild(t),null!==o&&s.removeChild(o)}if(document.querySelectorAll("#hex-container").length>0){let e=document.getElementById("svg-container"),t=document.getElementById("hex-container");e.removeChild(t)}document.getElementById("tab-display").style.display="none";let e=document.getElementsByClassName("tab-links");for(let t=0;t<e.length;t++)e[t].style.display="none"})),document.getElementById("run-button").addEventListener("click",(function(){const e=p(),t=[];e.forEach(h,t),t.forEach((t=>{let s=e.get(t),o=[];s.edges.forEach((e=>g(e,t,0,s,o)))}))}))})();